# ğŸ“‘ 3.0 â€” Secrets & Variables requis (GitHub Actions)

Dans GitHub Actions, on utilise **deux mÃ©canismes complÃ©mentaires** pour passer des informations Ã  nos workflows : les **Secrets** ğŸ”‘ et les **Variables** ğŸ“¦.
Ils se ressemblent mais **nâ€™ont pas le mÃªme rÃ´le** ni la mÃªme portÃ©e.

---

## ğŸ”‘ Secrets (sÃ©curisÃ©s)

### DÃ©finition

* Contiennent des **donnÃ©es sensibles** : mots de passe, clÃ©s privÃ©es SSH, tokens API, etc.
* **ChiffrÃ©s par GitHub** â†’ ils ne sont jamais affichÃ©s en clair dans les logs.

### VisibilitÃ©

* âŒ **Jamais visibles en public** (mÃªme dans les forks).
* âœ… Disponibles uniquement aux **workflows du repo** oÃ¹ ils sont dÃ©finis.

### Utilisation

```yaml
with:
  password: ${{ secrets.SSH_PASSWORD }}
```

### Points importants

* MasquÃ©s dans les logs (`***`).
* Ne peuvent **pas Ãªtre lus directement** dans un script (juste injectÃ©s).
* PortÃ©e : repo, organisation, ou environnement (prod/staging).

---

## ğŸ“¦ Variables (non sensibles)

### DÃ©finition

* Contiennent des **valeurs de configuration** non sensibles : noms dâ€™hÃ´tes, utilisateurs, flags, constantes.
* Exemple : `SSH_HOST=82.165.92.40`, `SSH_USER=root`.

### VisibilitÃ©

* âœ… **Lisibles en clair** dans lâ€™interface GitHub.
* âš ï¸ Donc **ne jamais y stocker un secret** (mot de passe, clÃ©).

### Utilisation

```yaml
with:
  host: ${{ vars.SSH_HOST }}
  username: ${{ vars.SSH_USER }}
```

### Points importants

* Pratiques pour **ne pas hardcoder** dans les workflows.
* Peuvent Ãªtre dÃ©finies au **repo**, **org**, ou **environnement**.
* Peuvent Ãªtre utilisÃ©es aussi dans les jobs/env (`env:`).

---

## ğŸ§© DiffÃ©rences clÃ©s

| Aspect              | **Secrets** ğŸ”‘                     | **Variables** ğŸ“¦            |
| ------------------- | ---------------------------------- | --------------------------- |
| **Usage**           | Infos sensibles (pwd, tokenâ€¦)      | Infos non sensibles (hostâ€¦) |
| **VisibilitÃ©**      | Jamais affichÃ©s                    | Lisibles en clair           |
| **Masquage logs**   | Oui (`***`)                        | Non                         |
| **Exemple typique** | `SSH_PASSWORD`, `GF_SMTP_PASSWORD` | `SSH_HOST`, `SSH_USER`      |

---

## âš™ï¸ IntÃ©gration dans la VM (runner)

* Lorsquâ€™un workflow dÃ©marre, GitHub injecte automatiquement **secrets** et **variables** dans lâ€™environnement du runner.
* Ils deviennent accessibles via la syntaxe :

    * `${{ secrets.MA_VARIABLE }}`
    * `${{ vars.MA_VARIABLE }}`

Exemple dâ€™injection dans un script :

```yaml
- name: Exemple dâ€™utilisation
  run: |
    echo "HÃ´te: ${{ vars.SSH_HOST }}"
    echo "User: ${{ vars.SSH_USER }}"
    echo "Password: ${{ secrets.SSH_PASSWORD }}" # masquÃ© dans logs
```

---

## âœ… Bonnes pratiques

* **Secrets** â†’ uniquement pour les donnÃ©es critiques (tokens, mots de passe, clÃ©s privÃ©es).
* **Variables** â†’ pour les constantes de config rÃ©utilisables (IP serveur, ports, users).
* Toujours **Ã©viter le hardcoding** dans les YAML.
* Si une valeur est utilisÃ©e par plusieurs workflows â†’ la mettre en **Org-level**.
* Pour les environnements (`staging`, `prod`), sÃ©parer **Secrets/Vars par environnement**.

---

## âš ï¸ Points Ã  ne pas oublier

* Les secrets ne sont **pas accessibles aux PRs venant dâ€™un fork** (sÃ©curitÃ© GitHub).
* Si tu veux exposer un secret comme variable dâ€™environnement dans un step :

  ```yaml
  env:
    SMTP_PASS: ${{ secrets.GF_SMTP_PASSWORD }}
  run: echo "Using secret safely"
  ```
* Attention : une variable mal utilisÃ©e peut **fuiter dans les logs** â†’ vÃ©rifier avec `masking`.

---

ğŸ‘‰ TL;DR :

* **Secrets** = sensibles, masquÃ©s, protÃ©gÃ©s â†’ ğŸ”‘ mots de passe, clÃ©s.
* **Variables** = non sensibles, visibles, pratiques â†’ ğŸ“¦ host, user, configs.
* Les deux sont injectÃ©s automatiquement dans la VM et utilisÃ©s via `${{ secrets.X }}` et `${{ vars.X }}`.
